CREATE DATABASE IF NOT EXISTS `xet`;

USE `xet`;

GRANT SELECT, INSERT, UPDATE, DELETE ON xet.* TO 'xet'@'localhost' IDENTIFIED BY 'xet';

CREATE TABLE IF NOT EXISTS `hooked_browsers` (
    id INT(4) NOT NULL AUTO_INCREMENT,
    last_heartbeat DATETIME,
    browser_id VARCHAR(32) NOT NULL,
    user_agent TEXT,
    hostname TEXT,
    public_ip TEXT,
    hooked_date DATETIME,
    vulnerable_url TEXT,
    origin TEXT,
    referer TEXT,
    cookies TEXT,
    local_storage TEXT,
    session_storage TEXT,
    source_code LONGTEXT,
    hooked_screenshot LONGTEXT,
    PRIMARY KEY (id),
    UNIQUE (browser_id)
);

CREATE TABLE IF NOT EXISTS `event_browsers` (
    id INT(4) NOT NULL AUTO_INCREMENT,
    date DATETIME,
    browser_id VARCHAR(32) NOT NULL,
    type TEXT,
    module TEXT,
    event TEXT,
    PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS `geoloc_browsers` (
    id INT(4) NOT NULL AUTO_INCREMENT,
    browser_id VARCHAR(32) NOT NULL,
    country TEXT,
    country_code TEXT,
    region_name TEXT,
    city TEXT,
    district TEXT,
    zip TEXT,
    lat TEXT,
    lon TEXT,
    isp TEXT,
    PRIMARY KEY (id),
    UNIQUE (browser_id)
);

CREATE TABLE IF NOT EXISTS `keylogger_browsers` (
    id INT(4) NOT NULL AUTO_INCREMENT,
    date DATETIME,
    browser_id VARCHAR(32) NOT NULL,
    keylogger_func TEXT,
    PRIMARY KEY (id),
    UNIQUE (browser_id)
);